# API 개발 고급 - 컬렉션 조회 최적화

### 강의 항목

* 주문 조회 V1: 엔티티 직접 노출
* 주문 조회 V2: 엔티티를 DTO로 변환
* 주문 조회 V3: 엔티티를 DTO로 변환 - 페치 조인 최적화
* 주문 조회 V3.1: 엔티티를 DTO로 변환 - 페이징과 한계 돌파
* 주문 조회 V4: JPA에서 DTO 직접 조회
* 주문 조회 V5: JPA에서 DTO 직접 조회 - 컬렉션 조회 최적화
* 주문 조회 V6: JPA에서 DTO로 직접 조회, 플랫 데이터 최적화
* API 개발 고급 정리



### 실습 코드

* 


### 학습 내용

* 주문 내역에서 추가로 주문한 상품 정보를 추가로 조회
* Order 기준으로 컬렉션인 OrderItem와 Item이 필요
* 앞 예제의 경우, toOne 관계만
  * OneToOne, ManyToOne
* 이번에는 컬렉션인 일대다 관계\(ManyToOne\)를 조회 및 최적화



#### V1: 엔티티 직접 노출

* 당연히 안좋은 방식
  * 엔티티가 변하면 API 스펙이 변한다
  * 트랜잭션 안에서 지연로딩 필요
  * 양방향 연관관계 문제, 무한루프 - JsonIgnore 설정 필요
  * Hibernate5Module 모듈 등록
  * LAZY 강제 초기화 처리
    * orderItem, item 관계를 직접 초기화하면 Hibernate5Module 설정에 의해 엔티티를 Json으로 생성



#### V2: 엔티티를 DTO로 변환

* 


#### V3: 엔티티를 DTO로 변환 - 페치 조인 최적화

#### V3.1: 엔티티를 DTO로 변환 - 페이징과 한계 돌파

#### V4: JPA에서 DTO 직접 조회

#### V5: JPA에서 DTO 직접 조회 - 컬렉션 조회 최적화

#### V6: JPA에서 DTO로 직접 조회, 플랫 데이터 최적화



#### API 개발 고급 정리





